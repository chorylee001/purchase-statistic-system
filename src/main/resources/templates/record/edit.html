<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<body class="hold-transition skin-blue sidebar-mini">
<section class="content-header">

    <h1>
        <a class="ajax-link" href="/record/index">话术管理</a>
        <small>话术修改</small>
    </h1>
</section>
<!-- Main content -->
<section class="content">
    <div class="box box-primary">
        <form class="form-horizontal main-from" id="mainForm" action="/record/o_update" method="post">
            <div class="box-body">
                <div class="form-group">
                    <label class="col-sm-2 control-label">话术名称<label class="warn-star">*</label></label>
                    <div class="col-sm-8">
                        <input type="text" name="documentDesc" class="form-control" placeholder="请添加小于20个汉字的话术名称" required th:value="${recordDesc.documentDesc}">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">所属企业<label class="warn-star">*</label></label>
                    <div class="col-sm-8">
                        <input type="hidden" name="companyId">
                        <select class="form-control select-control" style="width: 100%;" id="sel_company" name="companySel">
                            <div th:each="company : ${companys}">
                                <option name="company" th:selected="${company.id eq recordDesc.companyId}"  th:text="${company.companyName}" th:value="${company.id}"></option>
                            </div>
                        </select>
                    </div>
                </div>
                <!--<div class="form-group">
                  <label for="prologue">开场白<label class="warn-star">*</label></label>
                  <input type="file" id="prologue">
                  <p class="help-block">请上传wav格式音频开场白.</p>
                </div>-->
                <div class="form-group">
                    <label for="template" class="col-sm-2 control-label">话术文档</label>
                    <div class="col-sm-8">
                        <input type="file" id="template" name="template" onchange="checkExcelFile(this.files[0])">
                        <!--<p class="help-block">请上传excel格式话术文档.</p>-->
                    </div>
                </div>
                <!--<div class="form-group">
                    <label class="col-sm-2 control-label">开场白话术ID<label class="warn-star">*</label></label>
                    <div class="col-sm-8">
                        <input type="text" name="documentId" class="form-control" placeholder="">
                    </div>
                </div>-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">是否使用合成<label class="warn-star">*</label></label>
                    <div class="col-sm-8 radio-group">
                        <label>
                            <input type="radio" name="useCompose" class="minimal-red" value="0" th:checked="${recordDesc.useCompose eq 0}">&nbsp;&nbsp;否
                        </label>
                        <label>
                            <input type="radio" name="useCompose" class="minimal" value="1" th:checked="${recordDesc.useCompose eq 1}">&nbsp;&nbsp;是
                        </label>
                    </div>
                </div>
                <input type="hidden" th:value="${recordDesc.id}" name="id">
            </div>
            <div class="box-footer box-adjacent">
                <input type="button" class="btn btn-default roolback" value="返&nbsp;&nbsp;&nbsp;&nbsp;回"></input>
                <input type="button" class="btn btn-primary submit btn-adjacent" value="提&nbsp;&nbsp;&nbsp;&nbsp;交"></input>
            </div>
        </form>
    </div>
</section>
<script th:inline="javascript">
    $(function () {

        $('.select-control').select2();
        $('input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({
            checkboxClass: 'icheckbox_minimal-blue',
            radioClass: 'iradio_minimal-blue'
        })
        $('input[type="checkbox"].minimal-red, input[type="radio"].minimal-red').iCheck({
            checkboxClass: 'icheckbox_minimal-red',
            radioClass: 'iradio_minimal-red'
        })

        /**
         * 追加文件按钮
         */
        $(".append-button").on('click', function (e) {
            $("#audio_file").click();

            /*var ic = "<label for='file_input'>" +
                        "<input type='button' class='btn-file-input' " +"value='选择'>" +
                        "<span id='text'>请选择wav格式音频文件.</span>" +
                        "<input type='file' id='file_input'>" +
                    "</label>";
            $(".path-label").html(ic);*/
        })
        validateForm();
        /**
         * 保存
         */
        $("#mainForm .submit").on('click',function (e) {

            $('#mainForm').bootstrapValidator('validate');
            if(!$('#mainForm').data('bootstrapValidator').isValid()){
                return;
            }
            if ($('input').hasClass('error') || $(this).hasClass('error')) {
                return;
            } else {
                $("input[name='companyId']").val($("#sel_company").find("option:selected").val());
                LoadAjaxFileForm(document.getElementById("mainForm"));
            }
        });

        /**
         * 返回
         */
        $("#mainForm .roolback").on('click',function (e) {

            LoadAjaxContent("/record/index");
        });
    })
    function validateForm(){
        $('#mainForm').bootstrapValidator({
            message: '您输入的字符无效',
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                documentDesc: {
                    message: '话术名称无效.',
                    validators: {
                        notEmpty: {
                            message: '请输入话术名称.'
                        },
                        stringLength: {
                            min: 2,
                            max: 30,
                            message: '话术名称最少2个汉字，最多30个汉字.'
                        }
                        /*regexp: {
                            regexp: /^[a-zA-Z0-9_\.]+$/,
                            message: '话术名称只能由字母、数字、点和下划线组成'
                        },*/
                    }
                }
            }
        });
        // $("#mainForm")
    }
    uploadSuccess = function () {

    }
</script>
</body>
</html>
